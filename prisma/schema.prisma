generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model RSVP {
  id                 String   @id @default(cuid())
  fullName           String
  organization       String?
  email              String   @unique
  phone              String?
  attendanceStatus   String
  attendeeCount      Int
  dietaryPreference  String
  dietaryOther       String?
  accessibilityNeeds String?
  referralSource     String
  referralOther      String?
  wantsResources     Boolean  @default(false)
  wantsAudit         Boolean  @default(false)
  learningGoal       String?
  createdAt          DateTime @default(now())

  // NEW: analytics enrichments (all optional)
  visitorId   String?
  sessionId   String?
  referrer    String?
  eid         String?
  utmSource   String?
  utmMedium   String?
  utmCampaign String?
  utmTerm     String?
  utmContent  String?
  userAgent   String?
  language    String?
  tz          String?
  country     String?
  region      String?
  city        String?
  ipHash      String?
  screenW     Int?
  screenH     Int?
  dpr         Float?
  platform    String?
  device      String?
  browser     String?

  meta String?
}

model Visit {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())

  // identification
  visitorId String
  sessionId String

  // page
  path     String
  query    String?
  referrer String?

  // marketing
  eid         String?
  utmSource   String?
  utmMedium   String?
  utmCampaign String?
  utmTerm     String?
  utmContent  String?
  gclid       String?
  fbclid      String?
  msclkid     String?

  // client/device
  userAgent           String?
  language            String?
  languages           Json?
  tz                  String?
  screenW             Int?
  screenH             Int?
  dpr                 Float?
  platform            String?
  device              String?
  browser             String?
  viewportW           Int?
  viewportH           Int?
  orientation         String?
  deviceMemory        Float?
  hardwareConcurrency Int?
  maxTouchPoints      Int?
  connection          Json?
  storage             Json?
  navigation          Json?
  paint               Json?
  performance         Json?
  scrollDepth         Int?
  timeOnPageMs        Int?
  interactionCounts   Json?
  visibility          Json?

  // geo/IP (approx)
  country String?
  region  String?
  city    String?
  ipHash  String?
}
