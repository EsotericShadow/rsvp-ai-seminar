{"instruction": "How does event management work?", "input": "Explain ICS generation and event details management", "output": "I'll explain the complete event management system. Here's how ICS generation and event details are managed:\n\n**EVENT MANAGEMENT SYSTEM**\n\n**1. EVENT DATA STRUCTURE**\n```typescript\n// Event data constants and configuration\n// src/components/EventLanding.tsx\nconst VENUE_ADDRESS = \"4812 Hwy 16, Terrace, BC, Canada\";\nconst VENUE_NAME = \"Sunshine Inn Terrace — Jasmine Room\";\nconst EVENT_NAME = \"AI in Northern BC: Information Session\";\nconst START_ISO = \"2025-10-23T18:00:00-07:00\";\nconst END_ISO = \"2025-10-23T20:30:00-07:00\";\nconst EVENT_DESCRIPTION = \"A plain-language evening for Northern BC businesses: real local examples and clear first steps for adopting AI.\";\n\n// Event details for display\nconst detailItems: Array<{ label: string; value: string; href?: string }> = [\n  {\n    label: \"When\",\n    value: \"Thu, Oct 23 · Doors 6:00 PM · 6:30–8:30 PM\",\n    href: `/api/ics?title=${encodeURIComponent(EVENT_NAME)}&start=${encodeURIComponent(START_ISO)}&end=${encodeURIComponent(END_ISO)}&location=${encodeURIComponent(`${VENUE_NAME}, ${VENUE_ADDRESS}`)}&desc=${encodeURIComponent(EVENT_DESCRIPTION)}`\n  },\n  {\n    label: \"Where\",\n    value: VENUE_NAME,\n    href: \"https://www.google.com/maps/search/?api=1&query=\" + encodeURIComponent(`${VENUE_NAME} ${VENUE_ADDRESS}`)\n  },\n  {\n    label: \"Hosted by\",\n    value: \"Gabriel Lacroix • Evergreen Web Solutions\"\n  }\n];\n\n// Event takeaways and highlights\nconst takeaways = [\n  \"Real local examples of AI automation, machine learning, and custom AI integrations that worked — and what they cost.\",\n  \"Clear first steps for adopting AI in your business, tailored to Northern BC's unique challenges and opportunities.\",\n  \"Networking with other local business owners who are exploring AI solutions.\",\n  \"Q&A session with Gabriel Lacroix, who has implemented AI solutions for Northern BC businesses.\"\n];\n```\n\n**2. ICS CALENDAR GENERATION**\n```typescript\n// ICS calendar file generation\n// src/app/api/ics/route.ts\nimport { NextRequest, NextResponse } from 'next/server';\nimport { createEvent } from 'ics';\n\nexport async function GET(req: NextRequest) {\n  try {\n    const url = new URL(req.url);\n    const title = url.searchParams.get('title') || 'Event';\n    const start = url.searchParams.get('start') || new Date().toISOString();\n    const end = url.searchParams.get('end') || new Date(Date.now() + 2 * 60 * 60 * 1000).toISOString();\n    const location = url.searchParams.get('location') || '';\n    const description = url.searchParams.get('desc') || '';\n    \n    // Parse dates\n    const startDate = new Date(start);\n    const endDate = new Date(end);\n    \n    // Create ICS event\n    const { error, value } = createEvent({\n      title,\n      description,\n      location,\n      start: [\n        startDate.getFullYear(),\n        startDate.getMonth() + 1,\n        startDate.getDate(),\n        startDate.getHours(),\n        startDate.getMinutes()\n      ],\n      end: [\n        endDate.getFullYear(),\n        endDate.getMonth() + 1,\n        endDate.getDate(),\n        endDate.getHours(),\n        endDate.getMinutes()\n      ],\n      startInputType: 'utc',\n      endInputType: 'utc',\n      duration: { hours: 2, minutes: 30 },\n      organizer: {\n        name: 'Gabriel Lacroix',\n        email: 'gabriel@evergreenwebsolutions.ca'\n      },\n      url: 'https://rsvp.evergreenwebsolutions.ca',\n      status: 'CONFIRMED',\n      busyStatus: 'BUSY',\n      categories: ['Business', 'AI', 'Information Session'],\n      alarms: [\n        {\n          action: 'display',\n          trigger: { hours: 24, minutes: 0, before: true },\n          description: 'Reminder: AI in Northern BC Information Session tomorrow'\n        },\n        {\n          action: 'display',\n          trigger: { hours: 1, minutes: 0, before: true },\n          description: 'Reminder: AI in Northern BC Information Session in 1 hour'\n        }\n      ]\n    });\n    \n    if (error) {\n      console.error('ICS generation error:', error);\n      return NextResponse.json({ error: 'Failed to generate calendar event' }, { status: 500 });\n    }\n    \n    // Return ICS file\n    return new NextResponse(value, {\n      headers: {\n        'Content-Type': 'text/calendar; charset=utf-8',\n        'Content-Disposition': 'attachment; filename=\"ai-event-2025.ics\"',\n        'Cache-Control': 'no-cache, no-store, must-revalidate'\n      }\n    });\n  } catch (error) {\n    console.error('ICS API error:', error);\n    return NextResponse.json({ error: 'Internal server error' }, { status: 500 });\n  }\n}\n```\n\n**3. EVENT LANDING PAGE**\n```typescript\n// Event landing page component\n// src/components/EventLanding.tsx\nexport default function EventLanding() {\n  return (\n    <div className=\"relative min-h-[100svh] bg-white text-gray-900\">\n      {/* Structured Data */}\n      <StructuredData type=\"event\" />\n      <StructuredData type=\"breadcrumb\" />\n\n      {/* Header / Logo */}\n      <motion.header \n        initial={{ opacity: 0 }} \n        animate={{ opacity: 1 }} \n        transition={{ duration: 0.7, ease: EASE }} \n        className=\"w-full h-auto\"\n      >\n        <Link\n          href=\"https://evergreenwebsolutions.ca\"\n          target=\"_blank\"\n          rel=\"noreferrer\"\n          className=\"block w-full\"\n        >\n          <Image\n            src=\"/AI_in_terrace.svg\"\n            alt=\"AI in Northern BC\"\n            width={1000}\n            height={500}\n            priority\n            sizes=\"(max-width: 768px) 100vw, 100vw\"\n            className=\"w-full h-auto object-cover\"\n          />\n        </Link>\n      </motion.header>\n\n      {/* Main Content */}\n      <main className=\"px-4 sm:px-6 lg:px-8\">\n        {/* Hero Section */}\n        <motion.section\n          variants={containerVariants}\n          initial=\"hidden\"\n          animate=\"visible\"\n          className=\"mx-auto max-w-[68ch] py-10 sm:py-16 md:py-20 text-center space-y-5 sm:space-y-6\"\n        >\n          <motion.span\n            variants={itemVariants}\n            className=\"inline-flex items-center justify-center rounded-lg border border-gray-200 bg-gray-50 px-3 py-1 text-[10px] sm:text-[11px] font-medium uppercase tracking-[0.3em] sm:tracking-[0.35em] text-gray-600\"\n          >\n            Limited seats · RSVP closes Thu, Oct 16\n          </motion.span>\n\n          <motion.h1 \n            variants={itemVariants}\n            className=\"text-3xl sm:text-4xl md:text-5xl font-bold tracking-tight text-gray-900\"\n          >\n            {EVENT_NAME}\n          </motion.h1>\n\n          <motion.p \n            variants={itemVariants}\n            className=\"text-lg sm:text-xl text-gray-600 max-w-2xl mx-auto\"\n          >\n            {EVENT_DESCRIPTION}\n          </motion.p>\n        </motion.section>\n\n        {/* Event Details */}\n        <motion.section\n          variants={containerVariants}\n          initial=\"hidden\"\n          animate=\"visible\"\n          className=\"mx-auto max-w-4xl py-16\"\n        >\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n            {/* Event Information */}\n            <div className=\"space-y-6\">\n              <h2 className=\"text-2xl font-bold text-gray-900\">Event Details</h2>\n              \n              {detailItems.map((item, index) => (\n                <motion.div\n                  key={index}\n                  variants={itemVariants}\n                  className=\"flex items-start space-x-3\"\n                >\n                  <div className=\"flex-shrink-0 w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center\">\n                    <div className=\"w-2 h-2 bg-blue-600 rounded-full\"></div>\n                  </div>\n                  <div>\n                    <h3 className=\"font-semibold text-gray-900\">{item.label}</h3>\n                    {item.href ? (\n                      <a\n                        href={item.href}\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"text-blue-600 hover:text-blue-800 underline\"\n                      >\n                        {item.value}\n                      </a>\n                    ) : (\n                      <p className=\"text-gray-600\">{item.value}</p>\n                    )}\n                  </div>\n                </motion.div>\n              ))}\n            </div>\n\n            {/* Event Takeaways */}\n            <div className=\"space-y-6\">\n              <h2 className=\"text-2xl font-bold text-gray-900\">What You'll Learn</h2>\n              \n              <ul className=\"space-y-4\">\n                {takeaways.map((takeaway, index) => (\n                  <motion.li\n                    key={index}\n                    variants={itemVariants}\n                    className=\"flex items-start space-x-3\"\n                  >\n                    <div className=\"flex-shrink-0 w-6 h-6 bg-green-100 rounded-full flex items-center justify-center\">\n                      <svg className=\"w-3 h-3 text-green-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\n                      </svg>\n                    </div>\n                    <p className=\"text-gray-700\">{takeaway}</p>\n                  </motion.li>\n                ))}\n              </ul>\n            </div>\n          </div>\n        </motion.section>\n\n        {/* RSVP Form */}\n        <motion.section\n          variants={containerVariants}\n          initial=\"hidden\"\n          animate=\"visible\"\n          className=\"mx-auto max-w-2xl py-16\"\n        >\n          <div className=\"bg-gray-50 rounded-2xl p-8\">\n            <h2 className=\"text-2xl font-bold text-gray-900 text-center mb-8\">\n              Reserve Your Spot\n            </h2>\n            <RsvpForm />\n          </div>\n        </motion.section>\n      </main>\n    </div>\n  );\n}\n```\n\n**4. STRUCTURED DATA FOR SEO**\n```typescript\n// Structured data for search engines\n// src/components/StructuredData.tsx\nexport default function StructuredData({ type }: { type: 'event' | 'breadcrumb' }) {\n  if (type === 'event') {\n    const eventData = {\n      \"@context\": \"https://schema.org\",\n      \"@type\": \"Event\",\n      \"name\": EVENT_NAME,\n      \"description\": EVENT_DESCRIPTION,\n      \"startDate\": START_ISO,\n      \"endDate\": END_ISO,\n      \"location\": {\n        \"@type\": \"Place\",\n        \"name\": VENUE_NAME,\n        \"address\": {\n          \"@type\": \"PostalAddress\",\n          \"streetAddress\": \"4812 Hwy 16\",\n          \"addressLocality\": \"Terrace\",\n          \"addressRegion\": \"BC\",\n          \"addressCountry\": \"CA\"\n        }\n      },\n      \"organizer\": {\n        \"@type\": \"Person\",\n        \"name\": \"Gabriel Lacroix\",\n        \"email\": \"gabriel@evergreenwebsolutions.ca\"\n      },\n      \"offers\": {\n        \"@type\": \"Offer\",\n        \"price\": \"0\",\n        \"priceCurrency\": \"CAD\",\n        \"availability\": \"https://schema.org/InStock\"\n      },\n      \"eventStatus\": \"https://schema.org/EventScheduled\",\n      \"eventAttendanceMode\": \"https://schema.org/OfflineEventAttendanceMode\"\n    };\n\n    return (\n      <script\n        type=\"application/ld+json\"\n        dangerouslySetInnerHTML={{ __html: JSON.stringify(eventData) }}\n      />\n    );\n  }\n\n  if (type === 'breadcrumb') {\n    const breadcrumbData = {\n      \"@context\": \"https://schema.org\",\n      \"@type\": \"BreadcrumbList\",\n      \"itemListElement\": [\n        {\n          \"@type\": \"ListItem\",\n          \"position\": 1,\n          \"name\": \"Home\",\n          \"item\": \"https://evergreenwebsolutions.ca\"\n        },\n        {\n          \"@type\": \"ListItem\",\n          \"position\": 2,\n          \"name\": \"Events\",\n          \"item\": \"https://evergreenwebsolutions.ca/events\"\n        },\n        {\n          \"@type\": \"ListItem\",\n          \"position\": 3,\n          \"name\": EVENT_NAME,\n          \"item\": \"https://rsvp.evergreenwebsolutions.ca\"\n        }\n      ]\n    };\n\n    return (\n      <script\n        type=\"application/ld+json\"\n        dangerouslySetInnerHTML={{ __html: JSON.stringify(breadcrumbData) }}\n      />\n    );\n  }\n\n  return null;\n}\n```\n\n**5. EVENT CONFIRMATION EMAILS**\n```typescript\n// Event confirmation email generation\n// src/lib/sendgrid-email.ts\nexport async function sendRSVPConfirmation({\n  to,\n  name,\n  rsvpId\n}: {\n  to: string;\n  name: string;\n  rsvpId: string;\n}) {\n  const eventDetails = {\n    name: EVENT_NAME,\n    date: 'Thursday, October 23, 2025',\n    time: '6:00 PM - 8:30 PM',\n    location: VENUE_NAME,\n    address: VENUE_ADDRESS,\n    description: EVENT_DESCRIPTION\n  };\n\n  const msg = {\n    to: [to],\n    from: {\n      email: 'events@evergreenwebsolutions.ca',\n      name: 'AI Events'\n    },\n    replyTo: 'gabriel@evergreenwebsolutions.ca',\n    subject: `RSVP Confirmed: ${EVENT_NAME}`,\n    html: generateRSVPConfirmationHTML(name, eventDetails),\n    text: generateRSVPConfirmationText(name, eventDetails),\n    headers: {\n      'List-Unsubscribe': '<mailto:unsubscribe@evergreenwebsolutions.ca>',\n      'List-Unsubscribe-Post': 'List-Unsubscribe=One-Click',\n      'X-Campaign-ID': 'ai-event-2025',\n      'X-RSVP-ID': rsvpId,\n      'X-Mailer': 'Evergreen Web Solutions RSVP System'\n    },\n    categories: ['rsvp-confirmation', 'ai-event-2025'],\n    customArgs: {\n      rsvp_id: rsvpId,\n      event_type: 'rsvp-confirmation'\n    }\n  };\n\n  const response = await sgMail.send(msg);\n  return { \n    success: true, \n    messageId: response[0].headers['x-message-id'] as string\n  };\n}\n\nfunction generateRSVPConfirmationHTML(name: string, eventDetails: any): string {\n  return `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <meta charset=\"utf-8\">\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n      <title>RSVP Confirmed - ${eventDetails.name}</title>\n    </head>\n    <body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px;\">\n      <div style=\"background: #f8f9fa; padding: 20px; border-radius: 8px;\">\n        <h1 style=\"color: #2c3e50; margin-bottom: 20px;\">RSVP Confirmed!</h1>\n        <p style=\"font-size: 16px; margin-bottom: 20px;\">Hi ${name},</p>\n        <p style=\"font-size: 16px; margin-bottom: 20px;\">Thank you for RSVPing to our event. We're excited to see you there!</p>\n        \n        <div style=\"background: white; padding: 20px; border-radius: 8px; margin: 20px 0;\">\n          <h2 style=\"color: #2c3e50; margin-bottom: 15px;\">Event Details</h2>\n          <p><strong>Event:</strong> ${eventDetails.name}</p>\n          <p><strong>Date:</strong> ${eventDetails.date}</p>\n          <p><strong>Time:</strong> ${eventDetails.time}</p>\n          <p><strong>Location:</strong> ${eventDetails.location}</p>\n          <p><strong>Address:</strong> ${eventDetails.address}</p>\n        </div>\n        \n        <div style=\"background: #e8f4fd; padding: 15px; border-radius: 8px; margin: 20px 0;\">\n          <h3 style=\"color: #2c3e50; margin-bottom: 10px;\">Add to Calendar</h3>\n          <p style=\"margin-bottom: 10px;\">Don't forget to add this event to your calendar:</p>\n          <a href=\"${process.env.NEXT_PUBLIC_BASE_URL}/api/ics?title=${encodeURIComponent(eventDetails.name)}&start=${encodeURIComponent(START_ISO)}&end=${encodeURIComponent(END_ISO)}&location=${encodeURIComponent(`${eventDetails.location}, ${eventDetails.address}`)}&desc=${encodeURIComponent(eventDetails.description)}\" \n             style=\"display: inline-block; background: #3498db; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;\">\n            Download Calendar Event\n          </a>\n        </div>\n        \n        <p style=\"font-size: 14px; color: #666; margin-top: 20px;\">\n          If you have any questions, please contact us at gabriel@evergreenwebsolutions.ca\n        </p>\n      </div>\n    </body>\n    </html>\n  `;\n}\n```\n\n**6. EVENT ANALYTICS**\n```typescript\n// Event analytics and tracking\n// src/lib/event-analytics.ts\nexport async function trackEventEngagement(\n  eventType: 'page_view' | 'calendar_download' | 'rsvp_submit' | 'email_open' | 'email_click',\n  eventData: any\n) {\n  try {\n    // Track in database\n    await prisma.eventAnalytics.create({\n      data: {\n        eventType,\n        eventData: JSON.stringify(eventData),\n        timestamp: new Date()\n      }\n    });\n\n    // Post to LeadMine if applicable\n    if (eventData.inviteToken) {\n      await postLeadMineEvent({\n        token: eventData.inviteToken,\n        businessId: eventData.businessId,\n        type: `event_${eventType}`,\n        meta: {\n          eventName: EVENT_NAME,\n          eventDate: START_ISO,\n          ...eventData\n        }\n      });\n    }\n  } catch (error) {\n    console.error('Event analytics error:', error);\n  }\n}\n\nexport async function getEventAnalytics(): Promise<{\n  totalPageViews: number;\n  totalCalendarDownloads: number;\n  totalRSVPs: number;\n  conversionRate: number;\n  topReferrers: Array<{ source: string; count: number }>;\n  deviceBreakdown: Array<{ device: string; count: number }>;\n}> {\n  const [pageViews, calendarDownloads, rsvps, referrers, devices] = await Promise.all([\n    prisma.eventAnalytics.count({\n      where: { eventType: 'page_view' }\n    }),\n    prisma.eventAnalytics.count({\n      where: { eventType: 'calendar_download' }\n    }),\n    prisma.rsvp.count(),\n    prisma.eventAnalytics.groupBy({\n      by: ['eventData'],\n      where: { eventType: 'page_view' },\n      _count: { eventType: true }\n    }),\n    prisma.eventAnalytics.groupBy({\n      by: ['eventData'],\n      where: { eventType: 'page_view' },\n      _count: { eventType: true }\n    })\n  ]);\n\n  return {\n    totalPageViews: pageViews,\n    totalCalendarDownloads: calendarDownloads,\n    totalRSVPs: rsvps,\n    conversionRate: pageViews > 0 ? (rsvps / pageViews) * 100 : 0,\n    topReferrers: [], // Process referrer data\n    deviceBreakdown: [] // Process device data\n  };\n}\n```\n\n**7. EVENT CONFIGURATION**\n```typescript\n// Event configuration management\n// src/lib/event-config.ts\nexport const eventConfig = {\n  name: process.env.EVENT_NAME || 'AI in Northern BC: Information Session',\n  date: process.env.EVENT_DATE || '2025-10-23',\n  startTime: process.env.EVENT_START_TIME || '18:00',\n  endTime: process.env.EVENT_END_TIME || '20:30',\n  timezone: process.env.EVENT_TIMEZONE || 'America/Vancouver',\n  venue: {\n    name: process.env.VENUE_NAME || 'Sunshine Inn Terrace — Jasmine Room',\n    address: process.env.VENUE_ADDRESS || '4812 Hwy 16, Terrace, BC, Canada',\n    capacity: parseInt(process.env.VENUE_CAPACITY || '50')\n  },\n  organizer: {\n    name: process.env.ORGANIZER_NAME || 'Gabriel Lacroix',\n    email: process.env.ORGANIZER_EMAIL || 'gabriel@evergreenwebsolutions.ca',\n    company: process.env.ORGANIZER_COMPANY || 'Evergreen Web Solutions'\n  },\n  rsvp: {\n    deadline: process.env.RSVP_DEADLINE || '2025-10-16',\n    maxAttendees: parseInt(process.env.MAX_ATTENDEES || '50'),\n    requiresApproval: process.env.REQUIRES_APPROVAL === 'true'\n  }\n};\n\nexport function getEventISODate(): string {\n  const date = new Date(`${eventConfig.date}T${eventConfig.startTime}:00`);\n  return date.toISOString();\n}\n\nexport function getEventEndISODate(): string {\n  const date = new Date(`${eventConfig.date}T${eventConfig.endTime}:00`);\n  return date.toISOString();\n}\n\nexport function isRSVPOpen(): boolean {\n  const deadline = new Date(eventConfig.rsvp.deadline);\n  const now = new Date();\n  return now < deadline;\n}\n\nexport function getRemainingSpots(): number {\n  // This would query the database for current RSVP count\n  // For now, return a placeholder\n  return eventConfig.venue.capacity - 0; // Replace 0 with actual count\n}\n```\n\nThis comprehensive event management system provides ICS calendar generation, structured data for SEO, event confirmation emails, analytics tracking, and flexible configuration for your RSVP application."}

