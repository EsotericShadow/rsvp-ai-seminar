{"instruction": "How does the global HTML template system work?", "input": "Explain the global email template system", "output": "I'll explain the global HTML template system used in your RSVP application. Here's how it works:\n\n**Global Template System Architecture:**\n\n**1. Template Storage:**\n- Global templates are stored in the `GlobalHTMLTemplate` database table\n- Only one template can be active at a time (`isActive: true`)\n- Templates include full HTML structure with CSS styling\n\n**2. API Endpoint:**\n```\nGET /api/admin/global-template\n```\n\n**Response:**\n```json\n{\n  \"html\": \"<!DOCTYPE html>\\n<html lang=\\\"en\\\">\\n<head>\\n    <meta charset=\\\"utf-8\\\" />\\n    <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\" />\\n    <title>{{subject}}</title>\\n    <link href=\\\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap\\\" rel=\\\"stylesheet\\\" />\\n    <style>\\n        /* Full CSS styling for email template */\\n    </style>\\n</head>\\n<body>\\n    <!-- Complete HTML structure -->\\n</body>\\n</html>\"\n}\n```\n\n**3. Template Variables:**\nThe global template supports these variable categories:\n\n**Campaign Template Variables:**\n- `{{subject}}` - Email subject line\n- `{{greeting_title}}` - Greeting title\n- `{{greeting_message}}` - Greeting message\n- `{{main_content_title}}` - Main content title\n- `{{main_content_body}}` - Main content body\n- `{{button_text}}` - Call-to-action button text\n- `{{button_link}}` - Call-to-action button link\n- `{{additional_info_title}}` - Additional info title\n- `{{additional_info_body}}` - Additional info body\n- `{{closing_title}}` - Closing title\n- `{{closing_message}}` - Closing message\n\n**Global Template Variables:**\n- `{{global_hero_title}}` - Hero section title\n- `{{global_hero_message}}` - Hero section message\n- `{{global_signature_name}}` - Signature name\n- `{{global_signature_title}}` - Signature title\n- `{{global_signature_company}}` - Signature company\n- `{{global_signature_location}}` - Signature location\n- `{{global_event_title}}` - Event details title\n- `{{global_event_date}}` - Event date\n- `{{global_event_time}}` - Event time\n- `{{global_event_location}}` - Event location\n- `{{global_event_cost}}` - Event cost\n- `{{global_event_includes}}` - What's included\n\n**Business Variables:**\n- `{{business_name}}` - Business name\n- `{{business_id}}` - Business ID\n- `{{invite_link}}` - RSVP invite link\n- `{{unsubscribe_link}}` - Unsubscribe link\n\n**4. Template Processing:**\n```javascript\n// In email-template.ts\nexport async function generateEmailHTML(content) {\n  // Fetch global template from API\n  const response = await fetch('/api/admin/global-template');\n  const { html } = await response.json();\n  \n  // Replace all variables in template\n  const finalHTML = html\n    .replace(/\\{\\{subject\\}\\}/g, content.subject)\n    .replace(/\\{\\{greeting_title\\}\\}/g, content.greeting_title)\n    .replace(/\\{\\{main_content_body\\}\\}/g, content.body)\n    // ... all other variable replacements\n    \n  // Add tracking pixel\n  const trackingPixel = `<img src=\"/api/__pixel?token=${inviteToken}\" width=\"1\" height=\"1\" style=\"display:none;\" />`;\n  return finalHTML + trackingPixel;\n}\n```\n\n**5. Template Structure:**\n- **Header**: Logo, subject line\n- **Hero Section**: Green bar with hero title/message\n- **Content Sections**: Greeting, main content, buttons\n- **Event Details**: Structured event information\n- **Signature**: Professional signature block\n- **Footer**: Social links, unsubscribe, copyright\n\n**6. Styling Features:**\n- Responsive design with mobile breakpoints\n- Evergreen Web Solutions branding (green theme)\n- Professional typography using Inter font\n- Email-client compatible CSS\n- Social media links with icons\n- Accessibility features (ARIA labels, alt text)\n\n**7. Template Management:**\n```\nPOST /api/admin/global-template\n```\n\n**Request:**\n```json\n{\n  \"html\": \"<!DOCTYPE html>...\"\n}\n```\n\n**Response:**\n```json\n{\n  \"message\": \"Global template updated successfully\",\n  \"html\": \"<!DOCTYPE html>...\",\n  \"id\": \"template-id\"\n}\n```\n\n**8. Integration with Campaign System:**\n- Campaign templates store content in `htmlBody` field\n- Global template wraps campaign content\n- Variables are replaced during email generation\n- Tracking pixels are automatically added\n- Both HTML and text versions are generated\n\nThis system ensures consistent branding and styling across all email campaigns while allowing flexible content customization."}

{"instruction": "What template variables are available for email campaigns?", "input": "Show me all the template variables I can use", "output": "I'll show you all the template variables available in your RSVP email system. Here's the complete list:\n\n**CAMPAIGN TEMPLATE VARIABLES**\n(Stored in CampaignTemplate database fields)\n\n**Basic Content Variables:**\n- `{{subject}}` - Email subject line\n- `{{greeting_title}}` - Greeting section title\n- `{{greeting_message}}` - Greeting section message\n- `{{main_content_title}}` - Main content section title\n- `{{main_content_body}}` - Main content section body\n- `{{button_text}}` - Call-to-action button text\n- `{{button_link}}` - Call-to-action button link\n- `{{additional_info_title}}` - Additional information title\n- `{{additional_info_body}}` - Additional information body\n- `{{closing_title}}` - Closing section title\n- `{{closing_message}}` - Closing section message\n\n**Signature Variables:**\n- `{{signature_name}}` - Signature person name\n- `{{signature_title}}` - Signature person title\n- `{{signature_company}}` - Signature company name\n- `{{signature_location}}` - Signature location\n\n**GLOBAL TEMPLATE VARIABLES**\n(Used in global HTML template)\n\n**Hero Section:**\n- `{{global_hero_title}}` - Hero section title (default: \"Welcome to Evergreen AI\")\n- `{{global_hero_message}}` - Hero section message (default: \"Thank you for your interest...\")\n\n**Global Signature:**\n- `{{global_signature_name}}` - Global signature name (default: \"Gabriel Lacroix\")\n- `{{global_signature_title}}` - Global signature title (default: \"AI Solutions Specialist\")\n- `{{global_signature_company}}` - Global signature company (default: \"Evergreen Web Solutions\")\n- `{{global_signature_location}}` - Global signature location (default: \"Terrace, BC\")\n\n**Event Details:**\n- `{{global_event_title}}` - Event details title (default: \"Event Details\")\n- `{{global_event_date}}` - Event date (default: \"October 23rd, 2025\")\n- `{{global_event_time}}` - Event time (default: \"6:00 PM - 8:00 PM\")\n- `{{global_event_location}}` - Event location (default: \"Terrace, BC\")\n- `{{global_event_cost}}` - Event cost (default: \"Free\")\n- `{{global_event_includes}}` - What's included (default: \"Coffee, refreshments...\")\n\n**BUSINESS & TRACKING VARIABLES**\n(Generated dynamically)\n\n**Business Information:**\n- `{{business_name}}` - Recipient's business name\n- `{{business_id}}` - Recipient's business ID\n- `{{email}}` - Recipient's email address\n- `{{name}}` - Recipient's full name\n\n**Links & Tracking:**\n- `{{invite_link}}` - RSVP invite link with tracking\n- `{{unsubscribe_link}}` - Unsubscribe link\n- `{{inviteToken}}` - Unique invite token for tracking\n\n**VARIABLE USAGE EXAMPLES**\n\n**In Campaign Template (htmlBody):**\n```html\n<h2>{{greeting_title}}</h2>\n<p>{{greeting_message}}</p>\n<h3>{{main_content_title}}</h3>\n<p>{{main_content_body}}</p>\n<a href=\"{{button_link}}\" class=\"btn\">{{button_text}}</a>\n```\n\n**In Global Template:**\n```html\n<div class=\"hero-title\">{{global_hero_title}}</div>\n<p class=\"hero-sub\">{{global_hero_message}}</p>\n<h2>{{greeting_title}}</h2>\n<p>{{main_content_body}}</p>\n<a href=\"{{button_link}}\" class=\"btn\">{{button_text}}</a>\n<div class=\"event-details\">\n  <h3>{{global_event_title}}</h3>\n  <p><strong>Date:</strong> {{global_event_date}}</p>\n  <p><strong>Time:</strong> {{global_event_time}}</p>\n</div>\n```\n\n**VARIABLE REPLACEMENT PROCESS**\n\n**1. Campaign Template Processing:**\n```javascript\n// Replace campaign variables in template content\nconst processedContent = templateContent\n  .replace(/\\{\\{\\s*business_name\\s*\\}\\}/g, context.business_name)\n  .replace(/\\{\\{\\s*invite_link\\s*\\}\\}/g, context.invite_link);\n```\n\n**2. Global Template Processing:**\n```javascript\n// Replace all variables in global template\nconst finalHTML = globalTemplate\n  .replace(/\\{\\{subject\\}\\}/g, subject)\n  .replace(/\\{\\{greeting_title\\}\\}/g, greeting_title)\n  .replace(/\\{\\{main_content_body\\}\\}/g, body)\n  .replace(/\\{\\{global_hero_title\\}\\}/g, global_hero_title)\n  .replace(/\\{\\{global_event_date\\}\\}/g, global_event_date);\n```\n\n**VARIABLE DEFAULTS**\n\n**Global Template Defaults:**\n- `global_hero_title`: \"Welcome to Evergreen AI\"\n- `global_hero_message`: \"Thank you for your interest in our upcoming informational session...\"\n- `global_signature_name`: \"Gabriel Lacroix\"\n- `global_signature_title`: \"AI Solutions Specialist\"\n- `global_signature_company`: \"Evergreen Web Solutions\"\n- `global_signature_location`: \"Terrace, BC\"\n- `global_event_date`: \"October 23rd, 2025\"\n- `global_event_time`: \"6:00 PM - 8:00 PM\"\n- `global_event_location`: \"Terrace, BC\"\n- `global_event_cost`: \"Free\"\n- `global_event_includes`: \"Coffee, refreshments, networking, and actionable AI insights\"\n\n**Best Practices:**\n- Use `{{variable_name}}` syntax (double curly braces)\n- Variables are case-sensitive\n- Use meaningful variable names\n- Test templates with sample data\n- Provide fallback content for optional variables\n- Keep variable names consistent across templates"}

{"instruction": "How do I create a template with the global template system?", "input": "Create a template that uses the global template variables", "output": "I'll show you how to create a template that properly integrates with the global template system. Here's the complete process:\n\n**1. CREATE CAMPAIGN TEMPLATE**\n\n**API Endpoint:**\n```\nPOST /api/admin/campaign/templates\n```\n\n**Request Body:**\n```json\n{\n  \"name\": \"AI Seminar Invitation\",\n  \"subject\": \"{{global_hero_title}} - {{greeting_title}}\",\n  \"htmlBody\": \"<h2>{{greeting_title}}</h2><p>{{greeting_message}}</p><h3>{{main_content_title}}</h3><p>{{main_content_body}}</p><div class=\\\"button-container\\\"><a href=\\\"{{button_link}}\\\" class=\\\"btn\\\">{{button_text}}</a></div><h3>{{additional_info_title}}</h3><p>{{additional_info_body}}</p><h3>{{closing_title}}</h3><p>{{closing_message}}</p>\",\n  \"textBody\": \"{{greeting_title}}\\n\\n{{greeting_message}}\\n\\n{{main_content_title}}\\n{{main_content_body}}\\n\\n{{button_text}}: {{button_link}}\\n\\n{{additional_info_title}}\\n{{additional_info_body}}\\n\\n{{closing_title}}\\n{{closing_message}}\"\n}\n```\n\n**Response:**\n```json\n{\n  \"template\": {\n    \"id\": \"template-id-123\",\n    \"name\": \"AI Seminar Invitation\",\n    \"subject\": \"{{global_hero_title}} - {{greeting_title}}\",\n    \"htmlBody\": \"<h2>{{greeting_title}}</h2><p>{{greeting_message}}</p>...\",\n    \"textBody\": \"{{greeting_title}}\\n\\n{{greeting_message}}...\",\n    \"meta\": {},\n    \"greeting_title\": null,\n    \"greeting_message\": null,\n    \"signature_name\": null,\n    \"signature_title\": null,\n    \"signature_company\": null,\n    \"signature_location\": null,\n    \"main_content_title\": null,\n    \"main_content_body\": null,\n    \"button_text\": null,\n    \"additional_info_title\": null,\n    \"additional_info_body\": null,\n    \"closing_title\": null,\n    \"closing_message\": null,\n    \"createdAt\": \"2025-01-15T10:00:00Z\",\n    \"updatedAt\": \"2025-01-15T10:00:00Z\"\n  }\n}\n```\n\n**2. GLOBAL TEMPLATE STRUCTURE**\n\nThe global template automatically wraps your campaign content:\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"utf-8\" />\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\" />\n    <title>{{subject}}</title>\n    <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap\" rel=\"stylesheet\" />\n    <style>\n        /* Complete CSS styling */\n    </style>\n</head>\n<body>\n    <div class=\"evergreen-wrapper\">\n        <table class=\"evergreen-table\">\n            <!-- Header with logo and subject -->\n            <tr>\n                <td class=\"evergreen-header\">\n                    <h1>{{subject}}</h1>\n                    <div class=\"evergreen-logo\"></div>\n                </td>\n            </tr>\n            \n            <!-- Hero section with global variables -->\n            <tr>\n                <td>\n                    <table class=\"hero-inner\">\n                        <tr>\n                            <td class=\"hero-left\"></td>\n                            <td class=\"hero-right\">\n                                <div class=\"hero-title\">{{global_hero_title}}</div>\n                                <p class=\"hero-sub\">{{global_hero_message}}</p>\n                            </td>\n                        </tr>\n                    </table>\n                </td>\n            </tr>\n            \n            <!-- Your campaign content goes here -->\n            <tr>\n                <td class=\"content-cell\">\n                    {{greeting_title}}\n                    {{greeting_message}}\n                    {{main_content_title}}\n                    {{main_content_body}}\n                    {{button_text}}\n                    {{button_link}}\n                    {{additional_info_title}}\n                    {{additional_info_body}}\n                    {{closing_title}}\n                    {{closing_message}}\n                </td>\n            </tr>\n            \n            <!-- Event details section -->\n            <tr>\n                <td class=\"content-cell\">\n                    <div class=\"event-details\">\n                        <h3>{{global_event_title}}</h3>\n                        <p><strong>Date:</strong> {{global_event_date}}</p>\n                        <p><strong>Time:</strong> {{global_event_time}}</p>\n                        <p><strong>Location:</strong> {{global_event_location}}</p>\n                        <p><strong>Cost:</strong> {{global_event_cost}}</p>\n                        <p><strong>Includes:</strong> {{global_event_includes}}</p>\n                    </div>\n                </td>\n            </tr>\n            \n            <!-- Signature section -->\n            <tr>\n                <td class=\"content-cell\">\n                    <div class=\"evergreen-signature\">\n                        <p><strong>{{global_signature_name}}</strong><br>\n                        {{global_signature_title}}<br>\n                        {{global_signature_company}}<br>\n                        {{global_signature_location}}</p>\n                    </div>\n                </td>\n            </tr>\n            \n            <!-- Footer with social links and unsubscribe -->\n            <tr>\n                <td class=\"footer\">\n                    <div>Â© 2025 Gabriel Lacroix - Evergreen Web Solutions, Terrace BC</div>\n                    <div>\n                        <a href=\"https://www.linkedin.com/in/gabriel-marko-6b7aaa357/\">LinkedIn</a>\n                        <a href=\"https://www.facebook.com/share/14Exmoytvrs/\">Facebook</a>\n                        <a href=\"https://x.com/Evergreenweb3D\">X</a>\n                    </div>\n                    <div>\n                        <a href=\"{{unsubscribe_link}}\">unsubscribe here</a>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</body>\n</html>\n```\n\n**3. EMAIL GENERATION PROCESS**\n\n**Step 1: Campaign Template Processing**\n```javascript\n// In email-sender.ts\nconst processedContent = templateContent\n  .replace(/\\{\\{\\s*business_name\\s*\\}\\}/g, context.business_name)\n  .replace(/\\{\\{\\s*business_id\\s*\\}\\}/g, context.business_id)\n  .replace(/\\{\\{\\s*invite_link\\s*\\}\\}/g, context.invite_link);\n```\n\n**Step 2: Global Template Processing**\n```javascript\n// In email-template.ts\nconst html = await generateEmailHTML({\n  subject: schedule.template.subject,\n  greeting: 'Hello!',\n  body: processedContent,\n  ctaText: 'View details & RSVP',\n  ctaLink: context.invite_link,\n  inviteToken: member.inviteToken,\n  businessName: context.business_name,\n  businessId: context.business_id,\n  // Global template variables\n  global_hero_title: 'Welcome to Evergreen AI',\n  global_hero_message: 'Thank you for your interest...',\n  global_signature_name: 'Gabriel Lacroix',\n  global_signature_title: 'AI Solutions Specialist',\n  global_signature_company: 'Evergreen Web Solutions',\n  global_signature_location: 'Terrace, BC',\n  global_event_date: 'October 23rd, 2025',\n  global_event_time: '6:00 PM - 8:00 PM',\n  global_event_location: 'Terrace, BC',\n  global_event_cost: 'Free',\n  global_event_includes: 'Coffee, refreshments, networking, and actionable AI insights'\n});\n```\n\n**4. FINAL EMAIL STRUCTURE**\n\nThe final email combines:\n- **Global Template**: HTML structure, CSS styling, branding\n- **Campaign Content**: Your specific message content\n- **Dynamic Variables**: Business info, tracking links, personalization\n- **Tracking**: Pixel tracking, link tracking, engagement tracking\n\n**5. TEMPLATE VARIABLE HIERARCHY**\n\n**Priority Order:**\n1. **Campaign Template Variables** - Your specific content\n2. **Global Template Variables** - System-wide defaults\n3. **Business Variables** - Dynamic recipient data\n4. **Tracking Variables** - Generated links and tokens\n\n**6. BEST PRACTICES**\n\n**Template Design:**\n- Use semantic HTML structure\n- Include both HTML and text versions\n- Test with sample data\n- Keep content concise and focused\n- Use consistent variable naming\n\n**Variable Usage:**\n- Always provide fallback content\n- Use meaningful variable names\n- Test variable replacement\n- Document custom variables\n- Keep variables consistent across templates\n\n**Integration:**\n- Campaign templates store content only\n- Global template provides structure and styling\n- Variables are replaced during email generation\n- Both systems work together seamlessly\n\nThis system ensures consistent branding while allowing flexible content customization for each campaign."}

