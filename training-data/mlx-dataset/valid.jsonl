{"text": "### Instruction:\nImplement security measures\n\n### Input:\nHow do I secure email security?\n\n### Response:\nI'll help you implement security measures for Email Security. Here's a comprehensive security guide:\n\n**Topic:** Email Security\n**Description:** Secure email delivery and prevent abuse\n\n**Security Measures:**\n- SPF records\n- DKIM signing\n- DMARC policy\n- Rate limiting\n\n**Implementation:**\n```json\n{\n  \"security\": {\n    \"topic\": \"Email Security\",\n    \"measures\": [\"SPF records\", \"DKIM signing\", \"DMARC policy\", \"Rate limiting\"],\n    \"implementation\": {\n      \"encryption\": \"AES-256\",\n      \"authentication\": \"JWT tokens\",\n      \"rateLimiting\": \"100 req/min per IP\",\n      \"validation\": \"Zod schemas\"\n    }\n  }\n}\n```\n\n**Security Headers:**\n```javascript\nconst securityHeaders = {\n  'Content-Security-Policy': \"default-src 'self'\",\n  'X-Frame-Options': 'DENY',\n  'X-Content-Type-Options': 'nosniff',\n  'Referrer-Policy': 'strict-origin-when-cross-origin',\n  'Permissions-Policy': 'camera=(), microphone=(), geolocation=()'\n};\n```\n\n**Best Practices:**\n- Regular security audits\n- Keep dependencies updated\n- Use secure coding practices\n- Implement proper logging\n- Monitor for security issues\n- Train team on security\n\n**Compliance Requirements:**\n- GDPR: User consent, data portability, right to deletion\n- CAN-SPAM: Unsubscribe links, sender identification, truthful content\n- Industry standards: SOC 2, ISO 27001\n\n**Monitoring and Alerting:**\n- Failed login attempts\n- Unusual API usage\n- Data access patterns\n- Security event logging\n\nWould you like me to help you implement specific security measures?"}
{"text": "### Instruction:\nCreate a specific email template\n\n### Input:\nCreate a newsletter template\n\n### Response:\nI'll help you create a Newsletter template. Here's a comprehensive setup:\n\n**Template Type:** Newsletter\n\n**Suggested Structure:**\n\n**Subject Line:**\n```\n{{newsletterTitle}} - {{month}} {{year}}\n```\n\n**HTML Body Template:**\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Newsletter</title>\n</head>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px;\">\n    <div style=\"background: #f8f9fa; padding: 20px; border-radius: 8px;\">\n        <h1 style=\"color: #2c3e50; margin-bottom: 20px;\">{greeting_title}</h1>\n        <p style=\"font-size: 16px; margin-bottom: 20px;\">{greeting_message}</p>\n        \n        <div style=\"background: white; padding: 20px; border-radius: 6px; margin: 20px 0;\">\n            <h2 style=\"color: #34495e; margin-bottom: 15px;\">{main_content_title}</h2>\n            <p style=\"margin-bottom: 15px;\">This month's highlights, industry news, and company updates...</p>\n            \n            <div style=\"text-align: center; margin: 30px 0;\">\n                <a href=\"#\" style=\"background: #3498db; color: white; padding: 12px 24px; text-decoration: none; border-radius: 5px; display: inline-block;\">{button_text}</a>\n            </div>\n        </div>\n        \n        <div style=\"margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd;\">\n            <h3 style=\"color: #2c3e50; margin-bottom: 10px;\">{additional_info_title}</h3>\n            <p style=\"font-size: 14px; color: #666;\">{additional_info_body}</p>\n        </div>\n        \n        <div style=\"margin-top: 20px; text-align: center;\">\n            <p style=\"font-size: 14px; color: #666;\">{closing_title}</p>\n            <p style=\"font-size: 14px; color: #666;\">{closing_message}</p>\n        </div>\n        \n        <div style=\"margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd; text-align: center;\">\n            <p style=\"font-size: 12px; color: #999;\">\n                <strong>{signature_name}</strong><br>\n                {signature_title}<br>\n                {signature_company}<br>\n                {signature_location}\n            </p>\n            <p style=\"font-size: 12px; color: #999; margin-top: 10px;\">\n                <a href=\"{unsubscribeUrl}\" style=\"color: #999;\">Unsubscribe</a> | \n                <a href=\"#\" style=\"color: #999;\">Update Preferences</a>\n            </p>\n        </div>\n    </div>\n</body>\n</html>\n```\n\n**Text Body Template:**\n```\n{greeting_title}\n\n{greeting_message}\n\n{main_content_title}\nThis month's highlights, industry news, and company updates...\n\n{button_text}: [Link]\n\n{additional_info_title}\n{additional_info_body}\n\n{closing_title}\n{closing_message}\n\n---\n{signature_name}\n{signature_title}\n{signature_company}\n{signature_location}\n\nUnsubscribe: {unsubscribeUrl}\n```\n\n**Template Variables:**\n{{name}}, {{newsletterTitle}}, {{month}}, {{year}}, {{unsubscribeUrl}}\n\n**API Request:**\n```json\n{\n  \"name\": \"Newsletter Template\",\n  \"subject\": \"{{newsletterTitle}} - {{month}} {{year}}\",\n  \"htmlBody\": \"[HTML content above]\",\n  \"textBody\": \"[Text content above]\",\n  \"meta\": {},\n  \"greeting_title\": \"Welcome!\",\n  \"greeting_message\": \"Thank you for your interest\",\n  \"signature_name\": \"Your Name\",\n  \"signature_title\": \"Your Title\",\n  \"signature_company\": \"Your Company\",\n  \"signature_location\": \"Your Location\",\n  \"main_content_title\": \"Newsletter\",\n  \"main_content_body\": \"This month's highlights, industry news, and company updates...\",\n  \"button_text\": \"Learn More\",\n  \"additional_info_title\": \"Additional Information\",\n  \"additional_info_body\": \"For more details, visit our website\",\n  \"closing_title\": \"Thank You\",\n  \"closing_message\": \"Best regards\"\n}\n```\n\n**Best Practices for Newsletter:**\n- Keep subject line under 50 characters\n- Use clear, actionable language\n- Include unsubscribe link\n- Test on mobile devices\n- Personalize with recipient data\n- A/B test different versions\n\nWould you like me to customize this template for your specific needs?"}
{"text": "### Instruction:\nManage email campaigns\n\n### Input:\nShow me all campaigns\n\n### Response:\nI'll help you manage your campaigns. Here are the available actions:\n\n**List Campaigns:**\n```\nGET /api/admin/campaign/campaigns\n```\n\n**Response:**\n```json\n{\n  \"campaigns\": [\n    {\n      \"id\": \"campaign-id\",\n      \"name\": \"Campaign Name\",\n      \"description\": \"Description\",\n      \"status\": \"DRAFT\",\n      \"meta\": {},\n      \"createdAt\": \"2025-01-15T10:00:00Z\",\n      \"updatedAt\": \"2025-01-15T10:00:00Z\",\n      \"schedules\": []\n    }\n  ]\n}\n```\n\n**Get Campaign Details:**\n```\nGET /api/admin/campaign/campaigns/[id]\n```\n\n**Update Campaign:**\n```\nPUT /api/admin/campaign/campaigns\n```\n\n**Request Body:**\n```json\n{\n  \"id\": \"campaign-id\",\n  \"name\": \"Updated Name\",\n  \"description\": \"Updated description\",\n  \"status\": \"SCHEDULED\",\n  \"steps\": []\n}\n```\n\n**Delete Campaign:**\n```\nDELETE /api/admin/campaign/campaigns/[id]\n```\n\n**Campaign Status Values:**\n- `DRAFT` - Not yet ready\n- `SCHEDULED` - Scheduled to send\n- `SENDING` - Currently sending\n- `PAUSED` - Paused\n- `COMPLETED` - Finished\n- `CANCELLED` - Cancelled\n\nLet me execute the appropriate action for your request."}
{"text": "### Instruction:\nExplain system architecture and technical details\n\n### Input:\nWhat's the file structure?\n\n### Response:\nI'll explain the technical architecture of the RSVP system:\n\n**System Architecture:**\n\n**Frontend:**\n- **Framework**: Next.js 14 with React\n- **Styling**: Tailwind CSS\n- **Animations**: Framer Motion\n- **State Management**: React hooks (useState, useEffect)\n- **Authentication**: Session-based with cookies\n\n**Backend:**\n- **Runtime**: Node.js\n- **Framework**: Next.js API routes\n- **Database**: PostgreSQL with Prisma ORM\n- **Email Service**: Resend API\n- **Vector Database**: Weaviate (for RAG)\n- **AI Integration**: Gemini 2.5 Flash\n\n**Database Models:**\n- `RSVP` - Event RSVP submissions\n- `Visit` - Website visit tracking\n- `CampaignTemplate` - Email templates\n- `Campaign` - Email campaigns\n- `AudienceGroup` - Audience segmentation\n- `AudienceMember` - Individual audience members\n- `CampaignSchedule` - Campaign scheduling\n- `CampaignSend` - Individual email sends\n\n**API Structure:**\n- `/api/rsvp` - RSVP form submission\n- `/api/admin/campaign/campaigns` - Campaign management\n- `/api/admin/campaign/schedules` - Schedule management\n- `/api/admin/campaign/templates` - Template management\n- `/api/admin/campaign/groups` - Audience group management\n- `/api/admin/campaign/send` - Email sending\n- `/api/admin/export` - Data export\n- `/api/unsubscribe` - Unsubscribe handling\n- `/api/l/[token]` - Link tracking\n- `/api/__pixel` - Email open tracking\n\n**Security Features:**\n- CSRF protection with origin/referer validation\n- Rate limiting with IP fingerprinting\n- Input validation with Zod schemas\n- Test detection to prevent spam\n- Security logging for monitoring\n- Secure headers with CSP\n\n**Environment Variables:**\n- `DATABASE_URL` - PostgreSQL connection\n- `RESEND_API_KEY` - Email service\n- `GEMINI_API_KEY` - AI service\n- `WEAVIATE_URL` - Vector database\n- `WEAVIATE_API_KEY` - Vector database auth\n- `CRON_SECRET` - Cron job authentication\n\n**File Structure:**\n```\nrsvp-app/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 app/           # Next.js app router\n\u2502   \u2502   \u251c\u2500\u2500 api/       # API routes\n\u2502   \u2502   \u251c\u2500\u2500 admin/     # Admin panel\n\u2502   \u2502   \u2514\u2500\u2500 (public)/  # Public pages\n\u2502   \u251c\u2500\u2500 components/    # React components\n\u2502   \u251c\u2500\u2500 lib/          # Utilities and services\n\u2502   \u2514\u2500\u2500 prisma/       # Database schema\n\u251c\u2500\u2500 public/           # Static assets\n\u2514\u2500\u2500 docs/            # Documentation\n```\n\n**Deployment:**\n- **Platform**: Vercel (frontend)\n- **Database**: Neon (PostgreSQL)\n- **AI Service**: Railway (planned)\n- **Vector DB**: Weaviate Cloud\n\n**Email Delivery:**\n- Resend API for email sending\n- Throttling support (emails per minute)\n- Smart sending windows\n- Timezone support\n- Recurring campaigns\n- Link and open tracking\n\n**AI Assistant (Juniper):**\n- Conversational interface\n- Real-time execution display\n- Tool integration for database operations\n- Context awareness\n- Error handling and recovery\n- Pattern-matching system (to be replaced with fine-tuned SLM)\n\nThis architecture provides a scalable, secure, and maintainable system for RSVP management and email campaigns."}
{"text": "### Instruction:\nOptimize system performance\n\n### Input:\nHow do I optimize database performance?\n\n### Response:\nI'll help you optimize Database Performance. Here's a comprehensive optimization guide:\n\n**Area:** Database Performance\n\n**Common Issues:**\n- Slow queries\n- High memory usage\n- Connection timeouts\n\n**Optimization Solutions:**\n- Add indexes\n- Optimize queries\n- Use connection pooling\n- Implement caching\n\n**Performance Monitoring:**\n```json\n{\n  \"area\": \"Database Performance\",\n  \"metrics\": {\n    \"responseTime\": \"< 200ms\",\n    \"throughput\": \"> 1000 req/min\",\n    \"errorRate\": \"< 1%\",\n    \"uptime\": \"> 99.9%\"\n  },\n  \"alerts\": [\n    \"High response time\",\n    \"Error rate spike\",\n    \"Resource usage high\"\n  ]\n}\n```\n\n**Implementation Steps:**\n1. **Baseline Measurement**: Measure current performance\n2. **Identify Bottlenecks**: Find performance issues\n3. **Implement Solutions**: Apply optimization techniques\n4. **Test Performance**: Verify improvements\n5. **Monitor Continuously**: Set up ongoing monitoring\n\n**Tools and Techniques:**\n- Performance profiling\n- Database query analysis\n- API response time monitoring\n- Error rate tracking\n- Resource usage monitoring\n\n**Best Practices:**\n- Regular performance audits\n- Proactive monitoring\n- Gradual optimization\n- A/B testing improvements\n- Documentation of changes\n\nWould you like me to help you implement specific optimizations?"}
{"text": "### Instruction:\nManage email campaigns\n\n### Input:\nPause a campaign\n\n### Response:\nI'll help you manage your campaigns. Here are the available actions:\n\n**List Campaigns:**\n```\nGET /api/admin/campaign/campaigns\n```\n\n**Response:**\n```json\n{\n  \"campaigns\": [\n    {\n      \"id\": \"campaign-id\",\n      \"name\": \"Campaign Name\",\n      \"description\": \"Description\",\n      \"status\": \"DRAFT\",\n      \"meta\": {},\n      \"createdAt\": \"2025-01-15T10:00:00Z\",\n      \"updatedAt\": \"2025-01-15T10:00:00Z\",\n      \"schedules\": []\n    }\n  ]\n}\n```\n\n**Get Campaign Details:**\n```\nGET /api/admin/campaign/campaigns/[id]\n```\n\n**Update Campaign:**\n```\nPUT /api/admin/campaign/campaigns\n```\n\n**Request Body:**\n```json\n{\n  \"id\": \"campaign-id\",\n  \"name\": \"Updated Name\",\n  \"description\": \"Updated description\",\n  \"status\": \"SCHEDULED\",\n  \"steps\": []\n}\n```\n\n**Delete Campaign:**\n```\nDELETE /api/admin/campaign/campaigns/[id]\n```\n\n**Campaign Status Values:**\n- `DRAFT` - Not yet ready\n- `SCHEDULED` - Scheduled to send\n- `SENDING` - Currently sending\n- `PAUSED` - Paused\n- `COMPLETED` - Finished\n- `CANCELLED` - Cancelled\n\nLet me execute the appropriate action for your request."}
{"text": "### Instruction:\nManage email campaigns\n\n### Input:\nWhat campaigns do I have?\n\n### Response:\nI'll help you manage your campaigns. Here are the available actions:\n\n**List Campaigns:**\n```\nGET /api/admin/campaign/campaigns\n```\n\n**Response:**\n```json\n{\n  \"campaigns\": [\n    {\n      \"id\": \"campaign-id\",\n      \"name\": \"Campaign Name\",\n      \"description\": \"Description\",\n      \"status\": \"DRAFT\",\n      \"meta\": {},\n      \"createdAt\": \"2025-01-15T10:00:00Z\",\n      \"updatedAt\": \"2025-01-15T10:00:00Z\",\n      \"schedules\": []\n    }\n  ]\n}\n```\n\n**Get Campaign Details:**\n```\nGET /api/admin/campaign/campaigns/[id]\n```\n\n**Update Campaign:**\n```\nPUT /api/admin/campaign/campaigns\n```\n\n**Request Body:**\n```json\n{\n  \"id\": \"campaign-id\",\n  \"name\": \"Updated Name\",\n  \"description\": \"Updated description\",\n  \"status\": \"SCHEDULED\",\n  \"steps\": []\n}\n```\n\n**Delete Campaign:**\n```\nDELETE /api/admin/campaign/campaigns/[id]\n```\n\n**Campaign Status Values:**\n- `DRAFT` - Not yet ready\n- `SCHEDULED` - Scheduled to send\n- `SENDING` - Currently sending\n- `PAUSED` - Paused\n- `COMPLETED` - Finished\n- `CANCELLED` - Cancelled\n\nLet me execute the appropriate action for your request."}
{"text": "### Instruction:\nView analytics and generate reports\n\n### Input:\nGenerate an audience report\n\n### Response:\nI'll help you analyze your email performance. Here's what I can show you:\n\n**Campaign Analytics:**\n\n**CampaignSend Status Tracking:**\n```json\n{\n  \"id\": \"send-id\",\n  \"scheduleId\": \"schedule-id\",\n  \"groupId\": \"group-id\",\n  \"templateId\": \"template-id\",\n  \"businessId\": \"business-id\",\n  \"businessName\": \"Business Name\",\n  \"email\": \"email@example.com\",\n  \"inviteToken\": \"token\",\n  \"inviteLink\": \"https://example.com/l/token\",\n  \"resendMessageId\": \"resend-message-id\",\n  \"status\": \"SENT\",\n  \"error\": null,\n  \"meta\": {},\n  \"sentAt\": \"2025-01-15T10:00:00Z\",\n  \"openedAt\": \"2025-01-15T10:05:00Z\",\n  \"visitedAt\": \"2025-01-15T10:10:00Z\"\n}\n```\n\n**CampaignSend Status Values:**\n- `PENDING` - Not yet sent\n- `SENDING` - Currently being sent\n- `SENT` - Successfully sent\n- `FAILED` - Failed to send\n- `SKIPPED` - Skipped (e.g., unsubscribed)\n\n**Key Metrics:**\n- **Sent Count**: Total emails sent\n- **Open Rate**: Percentage of emails opened (openedAt not null)\n- **Click Rate**: Percentage of emails clicked (visitedAt not null)\n- **Bounce Rate**: Percentage of failed sends\n- **Unsubscribe Rate**: Percentage of unsubscribed members\n\n**Visit Tracking:**\n```json\n{\n  \"id\": \"visit-id\",\n  \"createdAt\": \"2025-01-15T10:00:00Z\",\n  \"visitorId\": \"visitor-id\",\n  \"sessionId\": \"session-id\",\n  \"path\": \"/event-page\",\n  \"query\": \"?utm_source=email\",\n  \"referrer\": \"https://example.com\",\n  \"eid\": \"event-id\",\n  \"utmSource\": \"email\",\n  \"utmMedium\": \"newsletter\",\n  \"utmCampaign\": \"summer-event\",\n  \"userAgent\": \"Mozilla/5.0...\",\n  \"language\": \"en-US\",\n  \"country\": \"Canada\",\n  \"region\": \"BC\",\n  \"city\": \"Vancouver\",\n  \"timeOnPageMs\": 30000,\n  \"scrollDepth\": 75\n}\n```\n\n**Analytics Endpoints:**\n- `GET /api/admin/campaign/dashboard` - Dashboard overview\n- `GET /api/admin/export` - Export data\n- `GET /api/l/[token]` - Track link clicks\n- `GET /api/__pixel` - Track email opens\n\n**Export Options:**\n- CSV format for RSVP data\n- JSON format for campaign data\n- Filtered by date range\n- Filtered by campaign/group\n\n**Performance Tracking:**\n- Email delivery rates\n- Open and click tracking\n- Geographic distribution\n- Device and browser analytics\n- Time-based performance\n- A/B testing results\n\nLet me generate the appropriate analytics report for your request."}
{"text": "### Instruction:\nView and manage RSVP data\n\n### Input:\nExport RSVP data\n\n### Response:\nI'll help you view RSVP data. Here's what I can show you:\n\n**RSVP Data Structure:**\n```json\n{\n  \"id\": \"rsvp-id\",\n  \"fullName\": \"John Doe\",\n  \"organization\": \"Company Name\",\n  \"email\": \"john@example.com\",\n  \"phone\": \"+1234567890\",\n  \"attendanceStatus\": \"CONFIRMED\",\n  \"attendeeCount\": 2,\n  \"dietaryPreference\": \"VEGETARIAN\",\n  \"dietaryOther\": \"No nuts\",\n  \"accessibilityNeeds\": \"Wheelchair access\",\n  \"referralSource\": \"WEBSITE\",\n  \"referralOther\": \"Google search\",\n  \"wantsResources\": true,\n  \"wantsAudit\": false,\n  \"learningGoal\": \"Learn about new technologies\",\n  \"createdAt\": \"2025-01-15T10:00:00Z\",\n  \"visitorId\": \"visitor-id\",\n  \"sessionId\": \"session-id\",\n  \"referrer\": \"https://example.com\",\n  \"eid\": \"event-id\",\n  \"utmSource\": \"google\",\n  \"utmMedium\": \"cpc\",\n  \"utmCampaign\": \"summer-event\",\n  \"utmTerm\": \"tech conference\",\n  \"utmContent\": \"banner-ad\",\n  \"userAgent\": \"Mozilla/5.0...\",\n  \"language\": \"en-US\",\n  \"tz\": \"America/Vancouver\",\n  \"country\": \"Canada\",\n  \"region\": \"BC\",\n  \"city\": \"Vancouver\",\n  \"ipHash\": \"hashed-ip\",\n  \"screenW\": 1920,\n  \"screenH\": 1080,\n  \"dpr\": 2.0,\n  \"platform\": \"MacIntel\",\n  \"device\": \"desktop\",\n  \"browser\": \"Chrome\",\n  \"meta\": \"additional data\"\n}\n```\n\n**Key Fields:**\n- `attendanceStatus` (string) - CONFIRMED, CANCELLED, etc.\n- `attendeeCount` (number) - Number of attendees\n- `dietaryPreference` (string) - Dietary requirements\n- `accessibilityNeeds` (string) - Accessibility requirements\n- `referralSource` (string) - How they found the event\n- `wantsResources` (boolean) - Wants additional resources\n- `wantsAudit` (boolean) - Wants audit information\n- `learningGoal` (string) - What they want to learn\n\n**Tracking Data:**\n- `visitorId` - Unique visitor identifier\n- `sessionId` - Session identifier\n- `referrer` - Referring URL\n- `utmSource`, `utmMedium`, `utmCampaign`, `utmTerm`, `utmContent` - UTM tracking\n- `userAgent` - Browser information\n- `language` - User language\n- `tz` - Timezone\n- `country`, `region`, `city` - Geographic data\n- `ipHash` - Hashed IP address\n- `screenW`, `screenH`, `dpr` - Screen information\n- `platform`, `device`, `browser` - Device information\n\n**Database Constraints:**\n- `email` field is unique\n- `id` is primary key (cuid)\n\n**API Endpoint:**\n```\nPOST /api/rsvp\n```\n\n**Security Features:**\n- CSRF protection\n- Rate limiting\n- Input validation\n- Test detection\n- Security logging\n\nLet me show you the RSVP data based on your request."}
{"text": "### Instruction:\nCreate a specific email template\n\n### Input:\nCreate a thank you template\n\n### Response:\nI'll help you create a Thank You template. Here's a comprehensive setup:\n\n**Template Type:** Thank You\n\n**Suggested Structure:**\n\n**Subject Line:**\n```\nThank you for {{action}}, {{name}}!\n```\n\n**HTML Body Template:**\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Thank You</title>\n</head>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px;\">\n    <div style=\"background: #f8f9fa; padding: 20px; border-radius: 8px;\">\n        <h1 style=\"color: #2c3e50; margin-bottom: 20px;\">{greeting_title}</h1>\n        <p style=\"font-size: 16px; margin-bottom: 20px;\">{greeting_message}</p>\n        \n        <div style=\"background: white; padding: 20px; border-radius: 6px; margin: 20px 0;\">\n            <h2 style=\"color: #34495e; margin-bottom: 15px;\">{main_content_title}</h2>\n            <p style=\"margin-bottom: 15px;\">We appreciate your support. Here's what happens next...</p>\n            \n            <div style=\"text-align: center; margin: 30px 0;\">\n                <a href=\"#\" style=\"background: #3498db; color: white; padding: 12px 24px; text-decoration: none; border-radius: 5px; display: inline-block;\">{button_text}</a>\n            </div>\n        </div>\n        \n        <div style=\"margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd;\">\n            <h3 style=\"color: #2c3e50; margin-bottom: 10px;\">{additional_info_title}</h3>\n            <p style=\"font-size: 14px; color: #666;\">{additional_info_body}</p>\n        </div>\n        \n        <div style=\"margin-top: 20px; text-align: center;\">\n            <p style=\"font-size: 14px; color: #666;\">{closing_title}</p>\n            <p style=\"font-size: 14px; color: #666;\">{closing_message}</p>\n        </div>\n        \n        <div style=\"margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd; text-align: center;\">\n            <p style=\"font-size: 12px; color: #999;\">\n                <strong>{signature_name}</strong><br>\n                {signature_title}<br>\n                {signature_company}<br>\n                {signature_location}\n            </p>\n            <p style=\"font-size: 12px; color: #999; margin-top: 10px;\">\n                <a href=\"{unsubscribeUrl}\" style=\"color: #999;\">Unsubscribe</a> | \n                <a href=\"#\" style=\"color: #999;\">Update Preferences</a>\n            </p>\n        </div>\n    </div>\n</body>\n</html>\n```\n\n**Text Body Template:**\n```\n{greeting_title}\n\n{greeting_message}\n\n{main_content_title}\nWe appreciate your support. Here's what happens next...\n\n{button_text}: [Link]\n\n{additional_info_title}\n{additional_info_body}\n\n{closing_title}\n{closing_message}\n\n---\n{signature_name}\n{signature_title}\n{signature_company}\n{signature_location}\n\nUnsubscribe: {unsubscribeUrl}\n```\n\n**Template Variables:**\n{{name}}, {{action}}, {{nextSteps}}, {{contactInfo}}\n\n**API Request:**\n```json\n{\n  \"name\": \"Thank You Template\",\n  \"subject\": \"Thank you for {{action}}, {{name}}!\",\n  \"htmlBody\": \"[HTML content above]\",\n  \"textBody\": \"[Text content above]\",\n  \"meta\": {},\n  \"greeting_title\": \"Welcome!\",\n  \"greeting_message\": \"Thank you for your interest\",\n  \"signature_name\": \"Your Name\",\n  \"signature_title\": \"Your Title\",\n  \"signature_company\": \"Your Company\",\n  \"signature_location\": \"Your Location\",\n  \"main_content_title\": \"Thank You\",\n  \"main_content_body\": \"We appreciate your support. Here's what happens next...\",\n  \"button_text\": \"Learn More\",\n  \"additional_info_title\": \"Additional Information\",\n  \"additional_info_body\": \"For more details, visit our website\",\n  \"closing_title\": \"Thank You\",\n  \"closing_message\": \"Best regards\"\n}\n```\n\n**Best Practices for Thank You:**\n- Keep subject line under 50 characters\n- Use clear, actionable language\n- Include unsubscribe link\n- Test on mobile devices\n- Personalize with recipient data\n- A/B test different versions\n\nWould you like me to customize this template for your specific needs?"}
{"text": "### Instruction:\nExplain system architecture and technical details\n\n### Input:\nExplain the API structure\n\n### Response:\nI'll explain the technical architecture of the RSVP system:\n\n**System Architecture:**\n\n**Frontend:**\n- **Framework**: Next.js 14 with React\n- **Styling**: Tailwind CSS\n- **Animations**: Framer Motion\n- **State Management**: React hooks (useState, useEffect)\n- **Authentication**: Session-based with cookies\n\n**Backend:**\n- **Runtime**: Node.js\n- **Framework**: Next.js API routes\n- **Database**: PostgreSQL with Prisma ORM\n- **Email Service**: Resend API\n- **Vector Database**: Weaviate (for RAG)\n- **AI Integration**: Gemini 2.5 Flash\n\n**Database Models:**\n- `RSVP` - Event RSVP submissions\n- `Visit` - Website visit tracking\n- `CampaignTemplate` - Email templates\n- `Campaign` - Email campaigns\n- `AudienceGroup` - Audience segmentation\n- `AudienceMember` - Individual audience members\n- `CampaignSchedule` - Campaign scheduling\n- `CampaignSend` - Individual email sends\n\n**API Structure:**\n- `/api/rsvp` - RSVP form submission\n- `/api/admin/campaign/campaigns` - Campaign management\n- `/api/admin/campaign/schedules` - Schedule management\n- `/api/admin/campaign/templates` - Template management\n- `/api/admin/campaign/groups` - Audience group management\n- `/api/admin/campaign/send` - Email sending\n- `/api/admin/export` - Data export\n- `/api/unsubscribe` - Unsubscribe handling\n- `/api/l/[token]` - Link tracking\n- `/api/__pixel` - Email open tracking\n\n**Security Features:**\n- CSRF protection with origin/referer validation\n- Rate limiting with IP fingerprinting\n- Input validation with Zod schemas\n- Test detection to prevent spam\n- Security logging for monitoring\n- Secure headers with CSP\n\n**Environment Variables:**\n- `DATABASE_URL` - PostgreSQL connection\n- `RESEND_API_KEY` - Email service\n- `GEMINI_API_KEY` - AI service\n- `WEAVIATE_URL` - Vector database\n- `WEAVIATE_API_KEY` - Vector database auth\n- `CRON_SECRET` - Cron job authentication\n\n**File Structure:**\n```\nrsvp-app/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 app/           # Next.js app router\n\u2502   \u2502   \u251c\u2500\u2500 api/       # API routes\n\u2502   \u2502   \u251c\u2500\u2500 admin/     # Admin panel\n\u2502   \u2502   \u2514\u2500\u2500 (public)/  # Public pages\n\u2502   \u251c\u2500\u2500 components/    # React components\n\u2502   \u251c\u2500\u2500 lib/          # Utilities and services\n\u2502   \u2514\u2500\u2500 prisma/       # Database schema\n\u251c\u2500\u2500 public/           # Static assets\n\u2514\u2500\u2500 docs/            # Documentation\n```\n\n**Deployment:**\n- **Platform**: Vercel (frontend)\n- **Database**: Neon (PostgreSQL)\n- **AI Service**: Railway (planned)\n- **Vector DB**: Weaviate Cloud\n\n**Email Delivery:**\n- Resend API for email sending\n- Throttling support (emails per minute)\n- Smart sending windows\n- Timezone support\n- Recurring campaigns\n- Link and open tracking\n\n**AI Assistant (Juniper):**\n- Conversational interface\n- Real-time execution display\n- Tool integration for database operations\n- Context awareness\n- Error handling and recovery\n- Pattern-matching system (to be replaced with fine-tuned SLM)\n\nThis architecture provides a scalable, secure, and maintainable system for RSVP management and email campaigns."}
{"text": "### Instruction:\nCreate and manage email templates\n\n### Input:\nMake a template for product announcements\n\n### Response:\nI'll help you create a new email template. Here's what I need:\n\n**Required Information:**\n1. **Template Name**: What should we call this template?\n2. **Subject**: Email subject line\n3. **HTML Body**: Rich HTML content\n4. **Text Body**: Plain text version (optional)\n\n**API Endpoint:**\n```\nPOST /api/admin/campaign/templates\n```\n\n**Request Body:**\n```json\n{\n  \"name\": \"Template Name\",\n  \"subject\": \"Email Subject\",\n  \"htmlBody\": \"<h1>Hello {name}</h1><p>Content here</p>\",\n  \"textBody\": \"Hello {name}\\n\\nContent here\",\n  \"meta\": {},\n  \"greeting_title\": \"Welcome!\",\n  \"greeting_message\": \"Thank you for joining us\",\n  \"signature_name\": \"Your Name\",\n  \"signature_title\": \"Your Title\",\n  \"signature_company\": \"Your Company\",\n  \"signature_location\": \"Your Location\",\n  \"main_content_title\": \"Main Title\",\n  \"main_content_body\": \"Main content here\",\n  \"button_text\": \"Click Here\",\n  \"additional_info_title\": \"Additional Info\",\n  \"additional_info_body\": \"Additional details\",\n  \"closing_title\": \"Thank You\",\n  \"closing_message\": \"Best regards\"\n}\n```\n\n**Required Fields:**\n- `name` (string) - Template name\n- `subject` (string) - Email subject\n- `htmlBody` (string) - HTML content\n- `meta` (object) - Template metadata\n\n**Optional Fields:**\n- `textBody` (string) - Plain text version\n- `greeting_title` (string) - Greeting title\n- `greeting_message` (string) - Greeting message\n- `signature_name` (string) - Signature name\n- `signature_title` (string) - Signature title\n- `signature_company` (string) - Signature company\n- `signature_location` (string) - Signature location\n- `main_content_title` (string) - Main content title\n- `main_content_body` (string) - Main content body\n- `button_text` (string) - Button text\n- `additional_info_title` (string) - Additional info title\n- `additional_info_body` (string) - Additional info body\n- `closing_title` (string) - Closing title\n- `closing_message` (string) - Closing message\n\n**Template Variables:**\n- `{name}` - Recipient's name\n- `{email}` - Recipient's email\n- `{firstName}` - First name\n- `{lastName}` - Last name\n- `{unsubscribeUrl}` - Unsubscribe link\n\n**Response:**\n```json\n{\n  \"template\": {\n    \"id\": \"template-id\",\n    \"name\": \"Template Name\",\n    \"subject\": \"Email Subject\",\n    \"htmlBody\": \"<h1>Hello {name}</h1>\",\n    \"textBody\": \"Hello {name}\",\n    \"meta\": {},\n    \"createdAt\": \"2025-01-15T10:00:00Z\",\n    \"updatedAt\": \"2025-01-15T10:00:00Z\"\n  }\n}\n```\n\nWould you like me to help you create this template with some default content?"}
{"text": "### Instruction:\nCreate audience segmentation strategy\n\n### Input:\nCreate a geographic segmentation group\n\n### Response:\nI'll help you create a Geographic Segmentation audience group. Here's a comprehensive setup:\n\n**Segmentation Strategy:** Geographic Segmentation\n**Description:** Segment by location, timezone, or region\n\n**Segmentation Criteria:**\n```json\n{\n  \"name\": \"Geographic Segmentation Group\",\n  \"description\": \"Segment by location, timezone, or region\",\n  \"color\": \"#10b981\",\n  \"criteria\": {\n  \"country\": \"Canada\",\n  \"region\": \"BC\",\n  \"city\": \"Vancouver\",\n  \"timezone\": \"America/Vancouver\"\n},\n  \"meta\": {\n    \"createdBy\": \"AI Assistant\",\n    \"purpose\": \"Segment by location, timezone, or region\",\n    \"lastUpdated\": \"2025-01-15T10:00:00Z\",\n    \"memberCount\": 0,\n    \"autoUpdate\": true\n  }\n}\n```\n\n**API Endpoint:**\n```\nPOST /api/admin/campaign/groups\n```\n\n**Implementation Steps:**\n1. **Define Criteria**: Set up the segmentation rules\n2. **Create Group**: Use the API to create the audience group\n3. **Populate Members**: Add existing members or import new ones\n4. **Test Segmentation**: Verify the criteria work correctly\n5. **Monitor Performance**: Track engagement and adjust as needed\n\n**Member Addition:**\n```json\n{\n  \"groupId\": \"group-id\",\n  \"businessId\": \"business-id\",\n  \"businessName\": \"Business Name\",\n  \"primaryEmail\": \"email@example.com\",\n  \"secondaryEmail\": \"secondary@example.com\",\n  \"tagsSnapshot\": [\"tag1\", \"tag2\"],\n  \"meta\": {\n    \"source\": \"import\",\n    \"addedBy\": \"AI Assistant\",\n    \"addedAt\": \"2025-01-15T10:00:00Z\"\n  }\n}\n```\n\n**Best Practices:**\n- Use clear, measurable criteria\n- Test with small groups first\n- Monitor engagement rates\n- Update criteria regularly\n- Document segmentation logic\n- Use consistent naming conventions\n\n**Performance Metrics:**\n- Open rates by segment\n- Click-through rates\n- Unsubscribe rates\n- Conversion rates\n- Engagement scores\n\n**Automation Opportunities:**\n- Auto-add new members based on criteria\n- Remove inactive members\n- Update tags based on behavior\n- Trigger campaigns based on segment changes\n\nWould you like me to help you implement this segmentation strategy?"}
{"text": "### Instruction:\nCreate and manage audience groups\n\n### Input:\nMake a group for high-value customers\n\n### Response:\nI'll help you create a new audience group. Here's what I need:\n\n**Required Information:**\n1. **Group Name**: What should we call this group?\n2. **Description**: What does this group represent?\n\n**API Endpoint:**\n```\nPOST /api/admin/campaign/groups\n```\n\n**Request Body:**\n```json\n{\n  \"name\": \"Group Name\",\n  \"description\": \"Description of the group\",\n  \"color\": \"#10b981\",\n  \"criteria\": {\n    \"industry\": \"technology\",\n    \"engagement\": \"high\",\n    \"tags\": [\"vip\", \"premium\"]\n  },\n  \"meta\": {}\n}\n```\n\n**Required Fields:**\n- `name` (string) - Group name\n- `description` (string) - Group description\n- `criteria` (object) - Group criteria\n- `meta` (object) - Group metadata\n\n**Optional Fields:**\n- `color` (string) - Group color (default: \"#10b981\")\n\n**Response:**\n```json\n{\n  \"group\": {\n    \"id\": \"group-id\",\n    \"name\": \"Group Name\",\n    \"description\": \"Description\",\n    \"color\": \"#10b981\",\n    \"criteria\": {},\n    \"meta\": {},\n    \"createdAt\": \"2025-01-15T10:00:00Z\",\n    \"updatedAt\": \"2025-01-15T10:00:00Z\",\n    \"members\": []\n  }\n}\n```\n\n**Audience Member Structure:**\n```json\n{\n  \"id\": \"member-id\",\n  \"groupId\": \"group-id\",\n  \"businessId\": \"business-id\",\n  \"businessName\": \"Business Name\",\n  \"primaryEmail\": \"email@example.com\",\n  \"secondaryEmail\": \"secondary@example.com\",\n  \"tagsSnapshot\": [\"tag1\", \"tag2\"],\n  \"inviteToken\": \"token\",\n  \"meta\": {},\n  \"createdAt\": \"2025-01-15T10:00:00Z\",\n  \"unsubscribed\": false\n}\n```\n\n**Member Status:**\n- `unsubscribed` (boolean) - Whether member has unsubscribed\n\n**Database Constraints:**\n- Unique constraint on `[groupId, businessId]`\n- Indexes on `groupId` and `businessId`\n\nWould you like me to help you set up the group criteria?"}
{"text": "### Instruction:\nCreate a specific email template\n\n### Input:\nCreate a survey request template\n\n### Response:\nI'll help you create a Survey Request template. Here's a comprehensive setup:\n\n**Template Type:** Survey Request\n\n**Suggested Structure:**\n\n**Subject Line:**\n```\nQuick Survey: Help us improve {{service}}\n```\n\n**HTML Body Template:**\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Survey Request</title>\n</head>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px;\">\n    <div style=\"background: #f8f9fa; padding: 20px; border-radius: 8px;\">\n        <h1 style=\"color: #2c3e50; margin-bottom: 20px;\">{greeting_title}</h1>\n        <p style=\"font-size: 16px; margin-bottom: 20px;\">{greeting_message}</p>\n        \n        <div style=\"background: white; padding: 20px; border-radius: 6px; margin: 20px 0;\">\n            <h2 style=\"color: #34495e; margin-bottom: 15px;\">{main_content_title}</h2>\n            <p style=\"margin-bottom: 15px;\">Your feedback is valuable. Take our 2-minute survey and get a special offer...</p>\n            \n            <div style=\"text-align: center; margin: 30px 0;\">\n                <a href=\"#\" style=\"background: #3498db; color: white; padding: 12px 24px; text-decoration: none; border-radius: 5px; display: inline-block;\">{button_text}</a>\n            </div>\n        </div>\n        \n        <div style=\"margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd;\">\n            <h3 style=\"color: #2c3e50; margin-bottom: 10px;\">{additional_info_title}</h3>\n            <p style=\"font-size: 14px; color: #666;\">{additional_info_body}</p>\n        </div>\n        \n        <div style=\"margin-top: 20px; text-align: center;\">\n            <p style=\"font-size: 14px; color: #666;\">{closing_title}</p>\n            <p style=\"font-size: 14px; color: #666;\">{closing_message}</p>\n        </div>\n        \n        <div style=\"margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd; text-align: center;\">\n            <p style=\"font-size: 12px; color: #999;\">\n                <strong>{signature_name}</strong><br>\n                {signature_title}<br>\n                {signature_company}<br>\n                {signature_location}\n            </p>\n            <p style=\"font-size: 12px; color: #999; margin-top: 10px;\">\n                <a href=\"{unsubscribeUrl}\" style=\"color: #999;\">Unsubscribe</a> | \n                <a href=\"#\" style=\"color: #999;\">Update Preferences</a>\n            </p>\n        </div>\n    </div>\n</body>\n</html>\n```\n\n**Text Body Template:**\n```\n{greeting_title}\n\n{greeting_message}\n\n{main_content_title}\nYour feedback is valuable. Take our 2-minute survey and get a special offer...\n\n{button_text}: [Link]\n\n{additional_info_title}\n{additional_info_body}\n\n{closing_title}\n{closing_message}\n\n---\n{signature_name}\n{signature_title}\n{signature_company}\n{signature_location}\n\nUnsubscribe: {unsubscribeUrl}\n```\n\n**Template Variables:**\n{{name}}, {{service}}, {{surveyUrl}}, {{incentive}}\n\n**API Request:**\n```json\n{\n  \"name\": \"Survey Request Template\",\n  \"subject\": \"Quick Survey: Help us improve {{service}}\",\n  \"htmlBody\": \"[HTML content above]\",\n  \"textBody\": \"[Text content above]\",\n  \"meta\": {},\n  \"greeting_title\": \"Welcome!\",\n  \"greeting_message\": \"Thank you for your interest\",\n  \"signature_name\": \"Your Name\",\n  \"signature_title\": \"Your Title\",\n  \"signature_company\": \"Your Company\",\n  \"signature_location\": \"Your Location\",\n  \"main_content_title\": \"Survey Request\",\n  \"main_content_body\": \"Your feedback is valuable. Take our 2-minute survey and get a special offer...\",\n  \"button_text\": \"Learn More\",\n  \"additional_info_title\": \"Additional Information\",\n  \"additional_info_body\": \"For more details, visit our website\",\n  \"closing_title\": \"Thank You\",\n  \"closing_message\": \"Best regards\"\n}\n```\n\n**Best Practices for Survey Request:**\n- Keep subject line under 50 characters\n- Use clear, actionable language\n- Include unsubscribe link\n- Test on mobile devices\n- Personalize with recipient data\n- A/B test different versions\n\nWould you like me to customize this template for your specific needs?"}
